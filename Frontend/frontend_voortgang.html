<html>
    <head>
    </head>

    <script>
        function slaOefeningOp() {
            var oefening = document.getElementById("ipoefening").value;
			var oefeningtijd = document.getElementById("ipoefeningtijd").value;
            var liftaantal = document.getElementById("ipliftaantal").value;
            var gewicht = document.getElementById("ipgewicht").value;
            var starttijd = document.getElementById("ipstarttijd").value;
            
			var voortgangObject = {};
			voortgangObject.oefeningtijd = oefeningtijd;
            voortgangObject.liftaantal = liftaantal;
            voortgangObject.gebruiktegewicht = gewicht;
            voortgangObject.starttijd = starttijd;

			var objJSON = JSON.stringify(voortgangObject);
            console.log(objJSON);
			var xhr = new XMLHttpRequest();
			xhr.onreadystatechange = function() {
                
				if(this.readyState == 4) {
					//alert(voortgangObject.oefening + " is opgeslagen");
				}
			};
			xhr.open("POST", "http://localhost:8082/vulVoortgang" + "/" + oefening, true);
			xhr.setRequestHeader("Content-Type", "application/json");
			xhr.send(objJSON);

            document.getElementById("oefeninginvullen").hidden = true;
            document.getElementById("vragenlijstinvullen").hidden = false;
            openVragenlijst();
        }

        function openVragenlijst() {
            var xhr = new XMLHttpRequest();
			xhr.onreadystatechange = function(){
                if(this.readyState == 4)
                {
                    var vraag = JSON.parse(this.responseText);
                    console.log(vraag);
                    document.getElementById("vraag").innerHTML = vraag.vragen;
                    // var allevragen = "";
                    // vragen.forEach(element => {
                    // allevragen += element + "<br>";
                    // })
                    
                }
            }
            xhr.open("GET","http://localhost:8082/vulVragenlijst",true);
            xhr.send();

            document.getElementById("allevragenlijsten").hidden = false;
        }

        function slaAntwoordOp(i) {
            var xhr = new XMLHttpRequest();
            var vragenlijsten = {};

            if(i == 0) {
                vragenlijsten.antwoorden = "goed";
            }
            else if(i == 1) {
                vragenlijsten.antwoorden = "matig";
            }
            else {
                vragenlijsten.antwoorden = "slecht";
            }
            var objJSON = JSON.stringify(vragenlijsten);

			xhr.onreadystatechange = function(){
                if(this.readyState == 4) {
                    
                }
            };
            xhr.open("POST", "http://localhost:8082/save/antwoord", true);
			xhr.setRequestHeader("Content-Type", "application/json");
			xhr.send(objJSON);
        }

        function verkrijgAlleVragenlijsten() {
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function(){
                if(this.readyState == 4) {
                    console.log(this.responseText);
                    var vragenlijsten = JSON.parse(this.responseText);
                    var antwoorden = "";
                    for(i = 0; i < vragenlijsten.length; i++)
                    {
                        antwoorden += vragenlijsten[i].antwoorden + "<br>";
                        document.getElementById("output").innerHTML = antwoorden;
                    }
                }
            };
            xhr.open("GET","http://localhost:8082/verkrijgVragenlijst",true);
            xhr.send();
        }
    </script>

    <body>
        <div id="oefeninginvullen">
            <b>Wat heb je voor training gedaan?</b>
            <br>
            <br>
            <i>OEFENING :</i>
            <br>
            <input type=text id=ipoefening value=14>
            <br>
            <i>totale tijd :</i>
            <br>
            <input type=number id=ipoefeningtijd value=20>
            <br>
            <i>liftaantal :</i>
            <br>
            <input type=number id=ipliftaantal value=17>
            <br>
            <i>gewicht :</i>
            <br>
            <input type=text id=ipgewicht value=19>
            <br>
            <i>starttijd :</i> 
            <br>
            <input type=datetime-local id=ipstarttijd>
            <br>
            <br>
            <input type=button value="voeg toe" onclick="slaOefeningOp()">
        </div>
        <div id="vragenlijstinvullen" hidden>
            <b>Nog even een korte vragenlijst!</b>
            <br>
            <br>
            <div id="vraag">Hier komt de vraag!</div>
            <br>
            <br>
            <input type=button value="goed" onclick="slaAntwoordOp(0)">
            <input type=button value="matig" onclick="slaAntwoordOp(1)">
            <input type=button value="slecht" onclick="slaAntwoordOp(2)">
        </div>
        <div id="allevragenlijsten" hidden>
            <b>Hier komen alle vragen</b>
            <input type=button value="voeg toe" onclick="verkrijgAlleVragenlijsten()">
            <div id=output>blabla</div>
        </div>
    </body>
</html>