<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
        integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
</head>
<script>
	var sporterID = new URL(window.location.href).searchParams.get("inlogID");
    function veranderIets(){
        document.getElementById("displayScherm").innerHTML = "<p>iets</p>";
    }
    function geefOefeningen(){
        var xhr = new XMLHttpRequest();
		xhr.onreadystatechange = function () {
			if (this.readyState == 4) {
				var rijtjeOefeningen = JSON.parse(this.responseText);
				var eindtekst = "";
				for (var x = 0; x < rijtjeOefeningen.length; x++) {
					eindtekst += "<a class=\"dropdown-item\" onclick = \"showOefening("+ rijtjeOefeningen[x].id 
                    + ")\">" + rijtjeOefeningen[x].naam + "</a>";
				}
				document.getElementById("oefeningen").innerHTML = eindtekst;
			}
		};
        xhr.open("GET", "http://localhost:8082/allOefeningen", true);
		xhr.send();
    }
	function showPlanning() {
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function () {
            if (this.readyState == 4) {
                var planning = JSON.parse(this.responseText);
                console.log(planning);
                var eindtekst = "<table class =\"table\">"
                    + "<thead class =\"thead-dark\"><tr>"
                    + "<th scope =\"col\">Tijd</th>"
                    + "<th scope = \"col\">Oefening</th>"
                    + "<th scope = \"col\">Aantal Reps </th>"
                    + "<th scope = \"col\">Gewicht</th></tr></thead><tbody>";
                    for (var y = 0; y < planning.training.length; y++) {
                        if (planning.training[y] != null)
                            eindtekst += "<tr>" +
                                "<td>" + planning.training[y].tijd +
                                "</td><td>" + planning.training[y].oefening.naam +
                                "</td><td>" + planning.training[y].aantalReps +
                                "</td><td>" + planning.training[y].gewicht + "</td></tr>";
                    }
              
                eindtekst += "</tbody></table>";
                document.getElementById("displayScherm").innerHTML = eindtekst;
				
            }
        };
        //HARDCODE 1
        xhr.open("GET", "http://localhost:8082/toonPlanning/" + sporterID, true);  //Moet dit window.sporterID zijn?
        xhr.send();

 	}
    function oefeningRegistreren(){
        document.getElementById("displayScherm").innerHTML = document.getElementById("oefeningRegistratieScherm").innerHTML
    }
    function verwijderModus() {
		var checkbox = document.getElementById("checkbox");
		if (checkbox.checked) {
			document.getElementById("ipoefening").disabled = true;
			document.getElementById("ipoefeningtijd").disabled = true;
			document.getElementById("ipliftaantal").disabled = true;
			document.getElementById("ipgewicht").disabled = true;
			document.getElementById("ipstarttijd").disabled = true;
			document.getElementById("ipID").disabled = false;
		} else {
			document.getElementById("ipoefening").disabled = false;
			document.getElementById("ipoefeningtijd").disabled = false;
			document.getElementById("ipliftaantal").disabled = false;
			document.getElementById("ipgewicht").disabled = false;
			document.getElementById("ipstarttijd").disabled = false;
			document.getElementById("ipID").disabled = true;
		}

	}
    function slaOefeningOp() {
		var oefening = document.getElementById("ipoefening").value;
		var oefeningtijd = document.getElementById("ipoefeningtijd").value;
		var liftaantal = document.getElementById("ipliftaantal").value;
		var gewicht = document.getElementById("ipgewicht").value;
		var starttijd = document.getElementById("ipstarttijd").value;

		var voortgangObject = {};
		voortgangObject.oefeningtijd = oefeningtijd;
		voortgangObject.liftaantal = liftaantal;
		voortgangObject.gebruiktegewicht = gewicht;
		voortgangObject.starttijd = starttijd;
		var objJSON = JSON.stringify(voortgangObject);
		var xhr = new XMLHttpRequest();
		xhr.onreadystatechange = function () {
			if (this.readyState == 4) {
			}
		};
		xhr.open("POST", "http://localhost:8082/vulVoortgang" + "/" + oefening, true);
		xhr.setRequestHeader("Content-Type", "application/json");
		xhr.send(objJSON);
		document.getElementById("displayScherm").innerHTML = document.getElementById("vragenlijstScherm").innerHTML;
		openVragenlijst();
	}

	function openVragenlijst() {
		var xhr = new XMLHttpRequest();
		xhr.onreadystatechange = function () {
			if (this.readyState == 4) {
				var vraag = JSON.parse(this.responseText);
				console.log(vraag);
				document.getElementById("vraag").innerHTML = vraag.vragen;
				// var allevragen = "";
				// vragen.forEach(element => {
				// allevragen += element + "<br>";
				// })

			}
		}
		xhr.open("GET", "http://localhost:8082/vulVragenlijst", true);
		xhr.send();
	}

	function slaAntwoordOp() {
		var xhr = new XMLHttpRequest();
		var idVoortgang = document.getElementById("voortgangID").value;
		var vragenlijsten = {};
		if(document.getElementById("antwoord-goed").checked){
			vragenlijsten.antwoorden="goed";
		}else if(document.getElementById("antwoord-matig").checked){
			vragenlijsten.antwoorden="matig";
		}else{
			vragenlijsten.antwoorden="slecht";
		}
		var objJSON = JSON.stringify(vragenlijsten);
		window.gevoel = vragenlijsten.antwoorden;
		xhr.onreadystatechange = function () {
			if (this.readyState == 4) {
				console.log(objJSON);
			}
		};
		xhr.open("POST", "http://localhost:8082/save/antwoord/"+window.sporterID, true);
		xhr.setRequestHeader("Content-Type", "application/json");
		xhr.send(objJSON);
		antwoordVoortgang(idVoortgang);
	}

	function antwoordVoortgang(id){
		var voortgangObject = {};
		voortgangObject.id = id;
		voortgangObject.antwoord = window.gevoel;
		var objJSON = JSON.stringify(voortgangObject);
		xhr = new XMLHttpRequest();
		xhr.onreadystatechange = function(){};
		xhr.open("POST","http://localhost:8082/voortgangAntwoord");
		xhr.setRequestHeader("Content-Type","application/json");
		xhr.send(objJSON);
	}

	function toonVoortgang() {
		var xhr = new XMLHttpRequest();
		xhr.onreadystatechange = function () {
			if (this.readyState == 4) {
				var rijtjeVoortgang = JSON.parse(this.responseText);
				var eindtekst = "<table class =\"table\">"
					+ "<thead class =\"thead-dark\"><tr>"
					+ "<th scope = \"col\">ID</th>"
					+ "<th scope = \"col\">Oefening</th>"
					+ "<th scope = \"col\">Gewicht</th>"
					+ "<th scope =\"col\">Starttijd</th>"
					+ "<th scope = \"col\">Tijdsduur</th>"
					+ "<th scope = \"col\">Aantal reps</th>"
					+ "<th scope = \"col\">Gegeven feedback</th>" 
					+ "<th scope = \"col\">Gevoel</tr></thead><tbody>";
				for (var x = 0; x < rijtjeVoortgang.length; x++) {
					eindtekst += "<tr><td>" + rijtjeVoortgang[x].id +
						"</td><td>" + rijtjeVoortgang[x].oefening.naam +
						"</td><td>" + rijtjeVoortgang[x].gebruiktegewicht +
						"</td><td>" + rijtjeVoortgang[x].starttijd +
						"</td><td>" + rijtjeVoortgang[x].oefeningtijd +
						"</td><td>" + rijtjeVoortgang[x].liftaantal +
						"</td><td>" + rijtjeVoortgang[x].feedback + 
						"</td><td>" + rijtjeVoortgang[x].antwoorden + "</td></tr>";
						console.log(rijtjeVoortgang[x].oefening);
				}
				eindtekst += "</tbody></table>";
				document.getElementById("displayScherm").innerHTML = document.getElementById("oefeningRegistratieScherm").innerHTML + eindtekst;
				
			}
		};
		xhr.open("GET", "http://localhost:8082/allVoortgang", true);
		xhr.send();
	}
	function verwijderOefening() {
		var ID = document.getElementById("ipID").value;
		var xhr = new XMLHttpRequest();
		xhr.onreadystatechange = function () {
			alert(ID + "is verwijderd uit de lijst");
		};
		xhr.open("POST", "http://localhost:8082/verwijderOefening", true);
		xhr.setRequestHeader("Content-Type", "application/json");
		xhr.send(ID);
	}
	function toonVoortgangVragenlijst() {
		var xhr = new XMLHttpRequest();
		xhr.onreadystatechange = function () {
			if (this.readyState == 4) {
				var rijtjeVoortgang = JSON.parse(this.responseText);
				var eindtekst = "<table class =\"table\">"
					+ "<thead class =\"thead-dark\"><tr>"
					+ "<th scope = \"col\">ID</th>"
					+ "<th scope = \"col\">Oefening</th>"
					+ "<th scope = \"col\">Gewicht</th>"
					+ "<th scope =\"col\">Starttijd</th>"
					+ "<th scope = \"col\">Tijdsduur</th>"
					+ "<th scope = \"col\">Aantal reps</th>"
					+ "<th scope = \"col\">Gegeven feedback</th>" 
					+ "<th scope = \"col\">Gevoel</tr></thead><tbody>";
				for (var x = 0; x < rijtjeVoortgang.length; x++) {
					eindtekst += "<tr><td>" + rijtjeVoortgang[x].id +
						"</td><td>" + rijtjeVoortgang[x].oefening.naam +
						"</td><td>" + rijtjeVoortgang[x].gebruiktegewicht +
						"</td><td>" + rijtjeVoortgang[x].starttijd +
						"</td><td>" + rijtjeVoortgang[x].oefeningtijd +
						"</td><td>" + rijtjeVoortgang[x].liftaantal +
						"</td><td>" + rijtjeVoortgang[x].feedback + 
						"</td><td>" + rijtjeVoortgang[x].antwoorden + "</td></tr>";
						console.log(rijtjeVoortgang[x].oefening);
				}
				eindtekst += "</tbody></table>";
				document.getElementById("tabelDiv").innerHTML = eindtekst;
				document.getElementById("tabelDiv").hidden = false;
			}
		};
		xhr.open("GET", "http://localhost:8082/allVoortgang", true);
		xhr.send();
	}
</script>
<body>
    <ul class="nav nav-pills">
        <li class="nav-item">
            <a class="nav-link" data-toggle="tab" onclick = "showPlanning()">Planning</a>
        </li>
        <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" data-toggle="dropdown"  role="button" aria-haspopup="true"
                aria-expanded="false">Oefeningen</a>
            <div class="dropdown-menu">
                <div id="oefeningen">
                    <script>geefOefeningen();</script>
                </div>
            </div>
        </li>
        <li class="nav-item">
            <a class="nav-link" data-toggle="tab" onclick = "oefeningRegistreren()">Oefening registreren</a>
        </li>
    </ul>
    <! -- DIT IS HET DISPLAY SCHERM -->
    <div id="displayScherm">
        <h1 class="display-5">WELKOM SPORTER </h1>
    </div>
    <! -- DIT IS HET OEFENING REGISTRATIE SCHERM -->
    <div id="oefeningRegistratieScherm" hidden>
        <form>
            <div class="form-group">
                <label>Wat heb je voor training gedaan?</label>
            </div>
            <div class="form-group">
                <label>Oefening </label>
                <input type=text id=ipoefening>
            </div>
            <div class="form-group">
                <label>Oefeningstijd </label>
                <input type=number id=ipoefeningtijd>
            </div>
            <div class="form-group">
                <label>Aantal reps </label>
                <input type=number id=ipliftaantal>
            </div>
            <div class="form-group">
                <label>Gewicht</label>
                <input type=text id=ipgewicht>
            </div>
            <div class="form-group">
                <label>Starttijd</label>
                <input type=datetime-local id=ipstarttijd>
            </div>
            <div class="form-group">
                <label>ID</label>
                <input type=text id=ipID disabled>
                <input type="checkbox" id="checkbox" onclick="verwijderModus()">
                <small class="form-text text-muted">Vul ID in voor verwijdering</small>
            </div>
            <input type=button value="Voeg toe" onclick="slaOefeningOp()">
            <input type=button value=ZieOefeningen onclick="toonVoortgang()">
            <input type=button value=verwijderOefening onclick="verwijderOefening()">
        </form>
    </div>
    <! -- DIT IS HET VRAGENLIJST SCHERM -->
    <div id="vragenlijstScherm" hidden>
        <b>Nog even een korte vragenlijst!</b>
			<br>
			<br>
			<div id="vraag">Hier komt de vraag!</div>
			<br>
			<br>
			<div id="uitleg id">Geef het ID op van de training waar je antwoord op wil geven.</div><br><br>
			<input type=text id="voortgangID"><input type=button value="Laat hele voortgangtabel zien" onclick="toonVoortgangVragenlijst()"><br><br>
			<input type="radio" id="antwoord-goed" name="antwoord" value="goed">
  			<label for="goed">Goed</label><br>
  			<input type="radio" id="antwoord-matig" name="antwoord" value="matig">
  			<label for="matig">Matig</label><br>
  			<input type="radio" id="antwoord-slecht" name="antwoord" value="slecht">
			<label for="slecht">Slecht</label><br>
			<input type=button id="verstuurAntwoord" value="Verstuur antwoord" onclick="slaAntwoordOp()">
			<b></b>
			<div id="tabelDiv"></div>
			<div id="allevragenlijsten" hidden>
				<input type=button value="voeg toe" onclick="verkrijgAlleVragenlijsten()">
				<div id=output></div>
			</div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
        integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
        crossorigin="anonymous"></script>
</body>

</html>